@inject LobbyConnection LobbyConnection

<h1>Blazor Skribbl</h1>
<p>Prepare the game using following settings:</p>
@if (IsHost)
{
    <EditForm Model="LobbySettings" OnValidSubmit="OnValuesChanged" class="mt-3">
        <div class="rounds-input d-flex flex-row">
            <span class="rounds-input--title">Rounds:</span>
            <div class="rounds-input--radios radios d-flex flex-row">
                @foreach (var roundLimit in LobbySettings.PossibleRoundsLimit)
                {
                    <label>
                        <InputRadioCustom name="round" SelectedValue="@roundLimit" @bind-Value="LobbySettings.RoundsLimit" @onclick="OnValuesChanged" IsDisabled="@false" />
                        <span>@roundLimit</span>
                    </label>
                }
            </div>
        </div>
        <div class="time-input d-flex flex-row">
            <span class="time-input--title">Time:</span>
            <div class="time-input--radios radios d-flex flex-row">
                @foreach (var timeLimit in LobbySettings.PossibleTimeLimit)
                {
                    <label>
                        <InputRadioCustom name="time" SelectedValue="timeLimit" @bind-Value="LobbySettings.TimeLimit" @onclick="OnValuesChanged" IsDisabled="@false" />
                        <span>@timeLimit</span>
                    </label>
                }
            </div>
        </div>
    </EditForm>
}
else
{
    <div> Rounds: @LobbySettings.RoundsLimit</div>
    <div> Time: @LobbySettings.TimeLimit</div>
}

<button class="start-button mt-2" @onclick="LobbyConnection.StartGame"> Start Game!</button>


@code {
    [Parameter] public LobbySettings LobbySettings { get; set; }
    [Parameter] public bool IsHost { get; set; }

    async Task OnValuesChanged()
    {
        Console.WriteLine("Values changed");
        await Task.Delay(50);
        await LobbyConnection.UpdateLobbySettings();
    }
}